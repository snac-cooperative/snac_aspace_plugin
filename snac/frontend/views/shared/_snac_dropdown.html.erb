<div id="snac-dropdown" class="btn-group dropdown" data-no-change-tracking="true">
  <a class="btn btn-sm btn-default dropdown-toggle snac-dropdown-toggle" data-toggle="dropdown" href="#" title="<%= I18n.t("actions.snac.label") %>">
    <%= I18n.t("actions.snac.label") %> <span class="caret"></span>
  </a>

  <ul class="dropdown-menu snac-dropdown-menu open-aligned-right">

      <% if has_snac_link?(type, obj) %>

        <li>
          <ul class="nav nav-tabs" id="snac-tabs" role="tablist">

            <li class="nav-item active">
              <a class="nav-link" id="snac-view-tab" data-toggle="tab" href="#snac-view-pane" role="tab" aria-controls="snac-view-pane" aria-selected="true">
                <%= I18n.t("actions.snac.view.label") %>
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" id="snac-unlink-tab" data-toggle="tab" href="#snac-unlink-pane" role="tab" aria-controls="snac-unlink-pane" aria-selected="false">
                <%= I18n.t("actions.snac.unlink.label") %>
              </a>
            </li>

          </ul>

          <div class="tab-content" id="snac-tab-content">

            <div class="tab-pane active" id="snac-view-pane" role="tabpanel" aria-labelledby="snac-view-tab">
              <p><%= I18n.t("actions.snac.view.#{type}_desc") %></p>

              <div class="form-actions">
                <%= link_to I18n.t("actions.snac.view.label"), snac_url(type, obj), :class => "btn btn-default pull=left", target: '_blank', rel: 'nofollow' %>

                <a class="btn btn-cancel btn-default pull-right" href="#"><%= I18n.t("actions.cancel") %></a>
              </div>
            </div>

            <div class="tab-pane" id="snac-unlink-pane" role="tabpanel" aria-labelledby="snac-unlink-tab">
              <p><%= I18n.t("actions.snac.unlink.#{type}_desc") %></p>

              <%= form_with url: url_for({:controller => :snac, :action => :unlink, :uris => [obj['uri']]}), local: false do |f| %>

                <div class="form-actions">
                  <%= f.submit I18n.t("actions.snac.unlink.label"),
                        :id => "unlink_submit",
                        :class => "btn snac-unlink-button btn-default pull-left",
                        data: { confirm: I18n.t("actions.snac.unlink.#{type}_confirm"), disable_with: I18n.t("actions.snac.unlink.label") }
                  %>

                  <a class="btn btn-cancel btn-default pull-right" href="#"><%= I18n.t("actions.cancel") %></a>
                </div>

              <% end %>
            </div>

          </div>
        </li>

      <% else %>

        <li>
          <ul class="nav nav-tabs" id="snac-tabs" role="tablist">

            <li class="nav-item active">
              <a class="nav-link" id="snac-export-tab" data-toggle="tab" href="#snac-export-pane" role="tab" aria-controls="snac-export-pane" aria-selected="false">
                <%= I18n.t("actions.snac.export.label") %>
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" id="snac-link-tab" data-toggle="tab" href="#snac-link-pane" role="tab" aria-controls="snac-link-pane" aria-selected="true">
                <%= I18n.t("actions.snac.link.label") %>
              </a>
            </li>

          </ul>

          <div class="tab-content" id="snac-tab-content">

            <div class="tab-pane active" id="snac-export-pane" role="tabpanel" aria-labelledby="snac-export-tab">
              <p><%= I18n.t("actions.snac.export.#{type}_desc") %></p>

              <%= form_with url: url_for({:controller => :snac, :action => :export, :uris => [obj['uri']]}), local: false do |f| %>

                <fieldset>
                  <% case type %>
                  <% when 'agent' %>
                    <div>
                      <%= f.check_box "include_linked_resources" %>
                      <%= I18n.t('actions.snac.options.include_linked_resources') %>
                    </div>
                  <% when 'resource' %>
                    <div>
                      <%= f.check_box "include_linked_agents" %>
                      <%= I18n.t('actions.snac.options.include_linked_agents') %>
                    </div>
                  <% end %>
                </fieldset>

                <div class="form-actions">
                  <%= f.submit I18n.t("actions.snac.export.label"),
                        :id => "export_submit",
                        :class => "btn snac-export-button btn-default pull-left",
                        data: { confirm: I18n.t("actions.snac.export.#{type}_confirm"), disable_with: I18n.t("actions.snac.export.label") }
                  %>

                  <a class="btn btn-cancel btn-default pull-right" href="#"><%= I18n.t("actions.cancel") %></a>
                </div>

              <% end %>
            </div>

            <div class="tab-pane" id="snac-link-pane" role="tabpanel" aria-labelledby="snac-link-tab">
              <p><%= I18n.t("actions.snac.link.#{type}_desc") %></p>

              <%= form_with url: url_for({:controller => :snac, :action => :link, :uris => [obj['uri']]}), local: false do |f| %>

                <fieldset>
                  <div>
                    <%= I18n.t('actions.snac.options.snac_source') %>:
                    <%= f.text_field "snac_source", id: "link_snac_source" %>
                  </div>
                </fieldset>

                <div class="form-actions">
                  <%= f.submit I18n.t("actions.snac.link.label"),
                        :id => "link_submit",
                        :class => "btn snac-link-button btn-default pull-left",
                        :disabled => "",
                        data: { confirm: I18n.t("actions.snac.link.#{type}_confirm"), disable_with: I18n.t("actions.snac.link.label") }
                  %>

                  <a class="btn btn-cancel btn-default pull-right" href="#"><%= I18n.t("actions.cancel") %></a>
                </div>

              <% end %>
            </div>

          </div>
        </li>

      <% end %>
  </ul>

  <script src="<%= "#{AppConfig[:frontend_proxy_prefix]}assets/javascripts/snac_dropdown.js" %>"></script>
  <link href="<%= "#{AppConfig[:frontend_proxy_prefix]}assets/styles/snac-dropdown.css" %>" media="all" rel="stylesheet" type="text/css">
</div>
